"use strict";!function(a){a.OffCanvasMenuController=function(a){function b(){g.$menuExpandedClassTarget.addClass(g.menuExpandedClass),g.$menu.css("display","block"),g.$menuToggle.attr({"aria-expanded":"true"})}function c(){g.$menuExpandedClassTarget.removeClass(g.menuExpandedClass),g.$menuToggle.attr({"aria-expanded":"false"}),setTimeout(function(){g.$menu.removeAttr("style")},f)}function d(){var a=g.$menuExpandedClassTarget.hasClass(g.menuExpandedClass)?"opened":"closed";"closed"===a&&b(),"opened"===a&&c()}if(a=a||{},this.$menu=a.$menu,this.menuExpandedClass=a.menuExpandedClass,0!=this.$menu.length&&this.menuExpandedClass){this.$menuToggle=a.$menuToggle||[],this.$menuExpandedClassTarget=a.$menuExpandedClassTarget||$("body"),this.position=a.position||"left",this.$wrapper=a.wrapper||$("#outer-wrapper"),this.wrapper=this.$wrapper[0],this.dragHandleOffset=a.dragHandleOffset||this.$menuToggle.outerWidth(),this.expandedWidth=this.$menu.outerWidth(),this.ariaControls=a.ariaControls||this.$menu.selector.replace("#","");var e=this.$wrapper.css("transition-duration"),f=1e3*e.replace("s","");if(this.$menuToggle.length>0){var g=this;this.$menuToggle.attr({role:"button","aria-controls":g.ariaControls,"aria-expanded":"false"}),this.$menuToggle.click(function(a){a.stopPropagation(),d()}),this.$wrapper.click(function(){c()}),this.$menuExpandedClassTarget.bind("keydown",function(a){27===a.keyCode&&g.$menuExpandedClassTarget.hasClass(g.menuExpandedClass)&&(c(),g.$menuToggle.focus())}),"left"===this.position&&(this.$menu.find("li:first-child a").bind("keydown",function(a){9===a.keyCode&&g.$menuExpandedClassTarget.hasClass(g.menuExpandedClass)&&a.shiftKey&&(a.preventDefault(),g.$menuToggle.focus())}),this.$menuToggle.bind("keydown",function(a){9===a.keyCode&&g.$menuExpandedClassTarget.hasClass(g.menuExpandedClass)&&(a.shiftKey||(a.preventDefault(),g.$menu.find("li:first-child a").focus()))})),"right"===this.position&&(this.$menuToggle.bind("keydown",function(a){9===a.keyCode&&g.$menuExpandedClassTarget.hasClass(g.menuExpandedClass)&&a.shiftKey&&(a.preventDefault(),g.$menu.find("li:last-child a").focus())}),this.$menu.find("li:last-child a").bind("keydown",function(a){9===a.keyCode&&g.$menuExpandedClassTarget.hasClass(g.menuExpandedClass)&&(a.shiftKey||(a.preventDefault(),g.$menuToggle.focus()))})),this.$menu.click(function(a){a.stopPropagation()})}this.wrapper.addEventListener&&(this.wrapper.addEventListener("touchstart",this,!1),this.wrapper.addEventListener("touchmove",this,!1),this.wrapper.addEventListener("touchend",this,!1),this.wrapper.addEventListener("touchcancel",this,!1))}},a.OffCanvasMenuController.prototype={start:null,handleEvent:function(a){switch(a.type){case"touchstart":this.onTouchStart(a);break;case"touchmove":this.onTouchMove(a);break;case"touchcancel":case"touchend":this.onTouchEnd(a)}},currentPosition:function(){return"left"==this.position?this.$menu.offset().left+this.expandedWidth:this.$menu.offset().left},inBounds:function(a){return"left"==this.position&&a>=0&&a<=this.expandedWidth||a>=-this.expandedWidth&&0>=a},onTouchStart:function(a){var b=a.touches[0].pageX;this.$menuExpandedClassTarget.hasClass(this.menuExpandedClass)&&(this.currentPosition()-this.dragHandleOffset>b||this.currentPosition()+this.dragHandleOffset<b||(this.start={startingX:this.currentPosition(),pageX:b,pageY:a.touches[0].pageY},this.deltaX=this.$wrapper.position().left,this.isScrolling=void 0,this.wrapper.style.MozTransitionDuration=this.wrapper.style.webkitTransitionDuration=0,a.stopPropagation()))},onTouchMove:function(b){if(this.start&&(this.deltaX=b.touches[0].pageX-this.start.pageX,"undefined"==typeof this.isScrolling&&(this.isScrolling=!!(this.isScrolling||Math.abs(this.deltaX)<Math.abs(b.touches[0].pageY-this.start.pageY))),!this.isScrolling)){b.preventDefault();var c="left"==this.position?this.start.startingX+this.deltaX:this.deltaX-($(a).width()-this.start.startingX);if(!this.inBounds(c))return;this.wrapper.style.MozTransform=this.wrapper.style.webkitTransform="translate("+c+"px,0)",b.stopPropagation()}},onTouchEnd:function(a){if(this.start){if(!this.isScrolling){var b="left"==this.position&&this.deltaX>0||"right"==this.position&&this.deltaX<0;this.$wrapper.attr("style","");var c=b?"addClass":"removeClass";this.$menuExpandedClassTarget[c](this.menuExpandedClass),"addClass"===c?(this.$menuToggle.attr({"aria-expanded":"true"}),this.$menu.css("display","block")):(this.$menuToggle.attr({"aria-expanded":"false"}),this.$menu.removeAttr("style"))}this.start=null,a.stopPropagation()}}}}(window);